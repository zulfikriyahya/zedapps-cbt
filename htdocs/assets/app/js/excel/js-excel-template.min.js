!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("exceljs")):"function"==typeof define&&define.amd?define(["exceljs"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).JsExcelTemplate=t(e.ExcelJS)}(this,function(e){"use strict";function t(r){var n=Object.create(null);return r&&Object.keys(r).forEach(function(e){var t;"default"!==e&&(t=Object.getOwnPropertyDescriptor(r,e),Object.defineProperty(n,e,t.get?t:{enumerable:!0,get:function(){return r[e]}}))}),n.default=r,Object.freeze(n)}var r=t(e),n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};function o(e,i,a,c){return new(a=a||Promise)(function(r,t){function n(e){try{l(c.next(e))}catch(e){t(e)}}function o(e){try{l(c.throw(e))}catch(e){t(e)}}function l(e){var t;e.done?r(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(n,o)}l((c=c.apply(e,i||[])).next())})}function l(n,o){var l,i,a,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},u={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function e(r){return function(e){var t=[r,e];if(l)throw new TypeError("Generator is already executing.");for(;c=u&&t[u=0]?0:c;)try{if(l=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,i=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(!(a=0<(a=c.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){c=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3]))c.label=t[1];else if(6===t[0]&&c.label<a[1])c.label=a[1],a=t;else{if(!(a&&c.label<a[2])){a[2]&&c.ops.pop(),c.trys.pop();continue}c.label=a[2],c.ops.push(t)}}t=o.call(n,c)}catch(e){t=[6,e],i=0}finally{l=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}}function d(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function i(){this.workbook=new r.Workbook}i.prototype.set=function(y,h,p){var t,e,r,n,v=this;if(Array.isArray(h)){if(0!==h.length){var o=function(s){s.eachRow(function(c,u){function a(e,t){var r,n,e=v.getFieldNames(e,y);try{r=void 0;for(var o=d(e),l=o.next();!l.done;l=o.next()){var i=l.value;if(null!=p&&p.duplicateCellIfArray){if(!f){for(var a=1;a<h.length;a++)c.getCell(t+a).value=c.getCell(t).value;f=!0}for(a=0;a<h.length;a++)v.setCell(c.getCell(t+a),"{".concat(y,".").concat(i,"}"),h[a][i])}else{f||(1<h.length&&s.duplicateRow(u,h.length-1,!0),f=!0);for(a=0;a<h.length;a++)v.setCell(s.getRow(u+a).getCell(t),"{".concat(y,".").concat(i,"}"),h[a][i])}}}catch(e){r={error:e}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}}var f=!1;c.eachCell(function(e,t){var r,n;if("string"==typeof e.value)a(e.value,t);else if("object"==typeof e.value&&e.value){e=e.value;if(e.richText&&Array.isArray(e.richText))try{r=void 0;for(var o=d(e.richText),l=o.next();!l.done;l=o.next()){var i=l.value;a(i.text,t)}}catch(e){r={error:e}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}}})})};try{for(var l=d(this.workbook.worksheets),i=l.next();!i.done;i=l.next())o(i.value)}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=l.return)&&e.call(l)}finally{if(t)throw t.error}}}}else try{for(var a=d(this.workbook.worksheets),c=a.next();!c.done;c=a.next())c.value.eachRow(function(e){e.eachCell(function(e){v.setCell(e,"{".concat(y,"}"),h)})})}catch(e){r={error:e}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}},i.prototype.toArrayBuffer=function(){return this.workbook.xlsx.writeBuffer()},i.prototype.getFieldNames=function(e,t){for(var r=[],n=0;0<=n&&n<e.length;){var o=e.indexOf("{".concat(t,"."),n);if(!(0<=o))break;var l=e.indexOf("}",o+"{".concat(t,".").length);if(!(0<=l))break;r.push(e.substring(o+"{".concat(t,".").length,l)),n=l}return r},i.prototype.setCell=function(e,t,r){var n,o;if(e.value)if("string"==typeof e.value)e.value.includes(t)&&(e.value=e.value===t?r:e.value.split(t).join(String(r)));else if("object"==typeof e.value){e=e.value;if(e.richText&&Array.isArray(e.richText))try{for(var l=d(e.richText),i=l.next();!i.done;i=l.next()){var a=i.value;a.text.includes(t)&&(a.text=a.text===t?String(r):a.text.split(t).join(String(r)))}}catch(e){n={error:e}}finally{try{i&&!i.done&&(o=l.return)&&o.call(l)}finally{if(n)throw n.error}}}};var a=i,c=f,e=a;if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function u(){this.constructor=c}function f(){return null!==a&&a.apply(this,arguments)||this}return n(c,e),c.prototype=null===e?Object.create(e):(u.prototype=e.prototype,new u),f.fromArrayBuffer=function(r){return o(this,void 0,void 0,function(){var t;return l(this,function(e){switch(e.label){case 0:return[4,(t=new f).workbook.xlsx.load(r)];case 1:return e.sent(),[2,t]}})})},f.prototype.toBlob=function(){return o(this,void 0,void 0,function(){var t;return l(this,function(e){switch(e.label){case 0:return[4,this.toArrayBuffer()];case 1:return t=e.sent(),[2,new Blob([t],{type:"application/octet-stream"})]}})})},f});
